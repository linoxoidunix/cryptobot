\hypertarget{market__order_8h_source}{}\doxysection{market\+\_\+order.\+h}
\label{market__order_8h_source}\index{/home/linoxoidunix/Programming/cplusplus/cryptobot/aot/strategy/market\_order.h@{/home/linoxoidunix/Programming/cplusplus/cryptobot/aot/strategy/market\_order.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{2 }
\DoxyCodeLine{3 \textcolor{preprocessor}{\#include <array>}}
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <sstream>}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{6 }
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include "{}aot/common/types.h"{}}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include "{}aot/third\_party/emhash/hash\_table7.hpp"{}}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include "{}boost/intrusive/avltree.hpp"{}}}
\DoxyCodeLine{10 }
\DoxyCodeLine{11 \textcolor{comment}{// using namespace common;}}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 \textcolor{keyword}{namespace }Trading \{}
\DoxyCodeLine{16 \textcolor{keyword}{struct }\mbox{\hyperlink{structTrading_1_1MarketOrder}{MarketOrder}} \{}
\DoxyCodeLine{17     common::OrderId order\_id\_ = common::OrderId\_INVALID;}
\DoxyCodeLine{18     common::Side side\_        = common::Side::INVALID;}
\DoxyCodeLine{19     common::Price price\_      = common::Price\_INVALID;}
\DoxyCodeLine{20     common::Qty qty\_          = common::Qty\_INVALID;}
\DoxyCodeLine{21     \textcolor{comment}{// common::Priority priority\_ = common::Priority\_INVALID;}}
\DoxyCodeLine{22 }
\DoxyCodeLine{25 }
\DoxyCodeLine{27     \mbox{\hyperlink{structTrading_1_1MarketOrder_af44347eb2bb2c2a5a03f667b761787d8}{MarketOrder}}()             = \textcolor{keywordflow}{default};}
\DoxyCodeLine{28 }
\DoxyCodeLine{29     \mbox{\hyperlink{structTrading_1_1MarketOrder_af44347eb2bb2c2a5a03f667b761787d8}{MarketOrder}}(common::OrderId order\_id, common::Side side,}
\DoxyCodeLine{30                 common::Price price, common::Qty qty) noexcept}
\DoxyCodeLine{31         : order\_id\_(order\_id), side\_(side), price\_(price), qty\_(qty) \{\}}
\DoxyCodeLine{32 }
\DoxyCodeLine{33     \textcolor{keyword}{auto} toString() const -\/> std::\textcolor{keywordtype}{string};}
\DoxyCodeLine{34 \};}
\DoxyCodeLine{35 }
\DoxyCodeLine{37 \textcolor{comment}{// typedef std::vector<MarketOrder*> OrderHashMap;}}
\DoxyCodeLine{38 }
\DoxyCodeLine{39 \textcolor{comment}{// typedef std::array<MarketOrder *, common::ME\_MAX\_ORDER\_IDS> OrderHashMap;}}
\DoxyCodeLine{40 }
\DoxyCodeLine{43 struct \mbox{\hyperlink{structTrading_1_1MarketOrdersAtPrice}{MarketOrdersAtPrice}} \{}
\DoxyCodeLine{44     common::Side side\_   = common::Side::INVALID;}
\DoxyCodeLine{45     common::Price price\_ = common::Price\_INVALID;}
\DoxyCodeLine{46 }
\DoxyCodeLine{47     \mbox{\hyperlink{structTrading_1_1MarketOrder}{MarketOrder}} first\_mkt\_order\_;}
\DoxyCodeLine{48 }
\DoxyCodeLine{52     boost::intrusive::avl\_set\_member\_hook<> \mbox{\hyperlink{structTrading_1_1MarketOrdersAtPrice_a8cfd6d0471dad31d4c81a51744319039}{member\_hook\_}};}
\DoxyCodeLine{53     \textcolor{keyword}{friend} \textcolor{keywordtype}{bool} operator<(\textcolor{keyword}{const} \mbox{\hyperlink{structTrading_1_1MarketOrdersAtPrice}{MarketOrdersAtPrice}} \&a,}
\DoxyCodeLine{54                           \textcolor{keyword}{const} \mbox{\hyperlink{structTrading_1_1MarketOrdersAtPrice}{MarketOrdersAtPrice}} \&b) \{}
\DoxyCodeLine{55         \textcolor{keywordflow}{return} a.price\_ < b.price\_;}
\DoxyCodeLine{56     \}}
\DoxyCodeLine{57     \textcolor{keyword}{friend} \textcolor{keywordtype}{bool} operator>(\textcolor{keyword}{const} \mbox{\hyperlink{structTrading_1_1MarketOrdersAtPrice}{MarketOrdersAtPrice}} \&a,}
\DoxyCodeLine{58                           \textcolor{keyword}{const} \mbox{\hyperlink{structTrading_1_1MarketOrdersAtPrice}{MarketOrdersAtPrice}} \&b) \{}
\DoxyCodeLine{59         \textcolor{keywordflow}{return} a.price\_ > b.price\_;}
\DoxyCodeLine{60     \}}
\DoxyCodeLine{61     \textcolor{keyword}{friend} \textcolor{keywordtype}{bool} operator==(\textcolor{keyword}{const} MarketOrdersAtPrice \&a,}
\DoxyCodeLine{62                            \textcolor{keyword}{const} MarketOrdersAtPrice \&b) \{}
\DoxyCodeLine{63         \textcolor{keywordflow}{return} a.price\_ == b.price\_;}
\DoxyCodeLine{64     \}}
\DoxyCodeLine{66     \mbox{\hyperlink{structTrading_1_1MarketOrdersAtPrice_ac9dcceaef4bdc83c8b280fd356b4d2b5}{MarketOrdersAtPrice}}() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{67 }
\DoxyCodeLine{68     \mbox{\hyperlink{structTrading_1_1MarketOrdersAtPrice}{MarketOrdersAtPrice}}(common::Side side, common::Price price,}
\DoxyCodeLine{69                         \textcolor{keyword}{const} \mbox{\hyperlink{structTrading_1_1MarketOrder}{MarketOrder}} \&first\_mkt\_order,}
\DoxyCodeLine{70                         \mbox{\hyperlink{structTrading_1_1MarketOrdersAtPrice}{MarketOrdersAtPrice}} *prev\_entry,}
\DoxyCodeLine{71                         \mbox{\hyperlink{structTrading_1_1MarketOrdersAtPrice}{MarketOrdersAtPrice}} *next\_entry)}
\DoxyCodeLine{72         : side\_(side),}
\DoxyCodeLine{73           price\_(price),}
\DoxyCodeLine{74           first\_mkt\_order\_(first\_mkt\_order.order\_id\_, first\_mkt\_order.side\_,}
\DoxyCodeLine{75                            first\_mkt\_order.price\_, first\_mkt\_order.qty\_) \{\}}
\DoxyCodeLine{76 }
\DoxyCodeLine{77     \textcolor{keyword}{auto} toString()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{78         std::stringstream ss;}
\DoxyCodeLine{79         ss << \textcolor{stringliteral}{"{}MarketOrdersAtPrice["{}} << \textcolor{stringliteral}{"{}side:"{}} << sideToString(side\_) << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{80            << \textcolor{stringliteral}{"{}price:"{}} << common::priceToString(price\_) << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{81            << \textcolor{stringliteral}{"{}first\_mkt\_order:"{}} << first\_mkt\_order\_.toString() << \textcolor{stringliteral}{"{}]"{}};}
\DoxyCodeLine{82 }
\DoxyCodeLine{83         \textcolor{keywordflow}{return} ss.str();}
\DoxyCodeLine{84     \}}
\DoxyCodeLine{85 \};}
\DoxyCodeLine{86 \textcolor{keyword}{using }MemberOption =}
\DoxyCodeLine{87     boost::intrusive::member\_hook<MarketOrdersAtPrice,}
\DoxyCodeLine{88                                   boost::intrusive::avl\_set\_member\_hook<>,}
\DoxyCodeLine{89                                   \&\mbox{\hyperlink{structTrading_1_1MarketOrdersAtPrice_a8cfd6d0471dad31d4c81a51744319039}{MarketOrdersAtPrice::member\_hook\_}}>;}
\DoxyCodeLine{90 \textcolor{keyword}{using }BidsatPriceMap = boost::intrusive::avltree<}
\DoxyCodeLine{91     MarketOrdersAtPrice,}
\DoxyCodeLine{92     boost::intrusive::compare<std::greater<MarketOrdersAtPrice>>, MemberOption>;}
\DoxyCodeLine{93 \textcolor{keyword}{using }AsksatPriceMap = boost::intrusive::avltree<}
\DoxyCodeLine{94     MarketOrdersAtPrice,}
\DoxyCodeLine{95     boost::intrusive::compare<std::less<MarketOrdersAtPrice>>, MemberOption>;}
\DoxyCodeLine{96 }
\DoxyCodeLine{98 \textcolor{keyword}{using }OrdersAtPriceHashMap =}
\DoxyCodeLine{99     emhash7::HashMap<common::Price, MarketOrdersAtPrice *>;}
\DoxyCodeLine{100 }
\DoxyCodeLine{104 }
\DoxyCodeLine{105 \textcolor{keyword}{struct }BBO;}
\DoxyCodeLine{106 }
\DoxyCodeLine{107 \textcolor{keyword}{struct }\mbox{\hyperlink{structTrading_1_1BBODouble}{BBODouble}} \{}
\DoxyCodeLine{108 }
\DoxyCodeLine{109     \textcolor{keywordtype}{double} bid\_price   = common::kPRICE\_DOUBLE\_INVALID;}
\DoxyCodeLine{110     \textcolor{keywordtype}{double} ask\_price   = common::kPRICE\_DOUBLE\_INVALID;}
\DoxyCodeLine{111     \textcolor{keywordtype}{double} bid\_qty     = common::kQTY\_DOUBLE\_INVALID;}
\DoxyCodeLine{112     \textcolor{keywordtype}{double} ask\_qty     = common::kQTY\_DOUBLE\_INVALID;}
\DoxyCodeLine{113     uint8\_t price\_prec = 0;}
\DoxyCodeLine{114     uint8\_t qty\_prec   = 0;}
\DoxyCodeLine{115 }
\DoxyCodeLine{116     \textcolor{keyword}{auto} ToString()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{117         \textcolor{keyword}{auto} bid\_qty\_string = (bid\_qty != common::kQTY\_DOUBLE\_INVALID)? fmt::format(\textcolor{stringliteral}{"{}\{:.\{\}f\}"{}}, bid\_qty, qty\_prec) : \textcolor{stringliteral}{"{}INVALID"{}};}
\DoxyCodeLine{118         \textcolor{keyword}{auto} ask\_qty\_string = (ask\_qty != common::kQTY\_DOUBLE\_INVALID)? fmt::format(\textcolor{stringliteral}{"{}\{:.\{\}f\}"{}}, ask\_qty, qty\_prec) : \textcolor{stringliteral}{"{}INVALID"{}};}
\DoxyCodeLine{119         \textcolor{keyword}{auto} bid\_price\_string = (bid\_price != common::kPRICE\_DOUBLE\_INVALID)? fmt::format(\textcolor{stringliteral}{"{}\{:.\{\}f\}"{}}, bid\_price, price\_prec) : \textcolor{stringliteral}{"{}INVALID"{}};}
\DoxyCodeLine{120         \textcolor{keyword}{auto} ask\_price\_string = (ask\_qty != common::kPRICE\_DOUBLE\_INVALID)? fmt::format(\textcolor{stringliteral}{"{}\{:.\{\}f\}"{}}, ask\_price, price\_prec) : \textcolor{stringliteral}{"{}INVALID"{}};}
\DoxyCodeLine{121         \textcolor{keywordflow}{return} fmt::format(\textcolor{stringliteral}{"{}BBODouble[\{\}@\{\}X\{\}@\{\}]"{}}, bid\_qty\_string, bid\_price\_string,}
\DoxyCodeLine{122                            ask\_price\_string, ask\_qty\_string);}
\DoxyCodeLine{123     \};}
\DoxyCodeLine{124     \textcolor{keyword}{explicit} \mbox{\hyperlink{structTrading_1_1BBODouble}{BBODouble}}(\textcolor{keyword}{const} \mbox{\hyperlink{structTrading_1_1BBO}{BBO}} *bbo, uint8\_t precission\_price,}
\DoxyCodeLine{125                        uint8\_t precission\_qty);}
\DoxyCodeLine{126     \textcolor{keyword}{explicit} \mbox{\hyperlink{structTrading_1_1BBODouble}{BBODouble}}() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{127 \};}
\DoxyCodeLine{128 }
\DoxyCodeLine{129 \textcolor{keyword}{struct }\mbox{\hyperlink{structTrading_1_1BBO}{BBO}} \{}
\DoxyCodeLine{130     common::Price bid\_price = common::Price\_INVALID;}
\DoxyCodeLine{131     common::Price ask\_price = common::Price\_INVALID;}
\DoxyCodeLine{132     common::Qty bid\_qty     = common::Qty\_INVALID;}
\DoxyCodeLine{133     common::Qty ask\_qty     = common::Qty\_INVALID;}
\DoxyCodeLine{134 }
\DoxyCodeLine{135     \textcolor{keyword}{auto} toString()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{136         std::stringstream ss;}
\DoxyCodeLine{137         ss << \textcolor{stringliteral}{"{}BBO\{"{}} << common::qtyToString(bid\_qty) << \textcolor{stringliteral}{"{}@"{}}}
\DoxyCodeLine{138            << common::priceToString(bid\_price) << \textcolor{stringliteral}{"{}X"{}}}
\DoxyCodeLine{139            << common::priceToString(ask\_price) << \textcolor{stringliteral}{"{}@"{}}}
\DoxyCodeLine{140            << common::qtyToString(ask\_qty) << \textcolor{stringliteral}{"{}\}"{}};}
\DoxyCodeLine{141 }
\DoxyCodeLine{142         \textcolor{keywordflow}{return} ss.str();}
\DoxyCodeLine{143     \};}
\DoxyCodeLine{144     \textcolor{keyword}{explicit} \mbox{\hyperlink{structTrading_1_1BBO}{BBO}}(\textcolor{keyword}{const} \mbox{\hyperlink{structTrading_1_1BBODouble}{BBODouble}} *bbo\_double, uint8\_t precission\_price,}
\DoxyCodeLine{145                  uint8\_t precission\_qty);}
\DoxyCodeLine{146     \textcolor{keyword}{explicit} \mbox{\hyperlink{structTrading_1_1BBO}{BBO}}() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{147 \};}
\DoxyCodeLine{148 \}  \textcolor{comment}{// namespace Trading}}

\end{DoxyCode}
